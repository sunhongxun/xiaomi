{"ast":null,"code":"var _jsxFileName = \"G:\\\\tanzhou\\\\react_shizhan\\\\xiaomireact\\\\xiaomi\\\\src\\\\components\\\\shopCar\\\\shopCar.jsx\";\nimport React, { Component } from 'react';\nimport { List, Stepper, Checkbox, Toast } from \"antd-mobile\";\nimport { Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { offline } from \"../../common/js/toast/toast\";\nimport Top from \"../Header/top\";\nimport './shopcar.css';\nimport url from \"../util\";\nimport { goback } from \"../util\";\nimport { addgood, delgood, getgoodsnum } from \"../../actions/cart\";\nimport { shopTools } from \"../util\"; // const customIcon = () => (\n//     <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\" className=\"am-icon am-icon-md\">\n//         <path fillRule=\"evenodd\" d=\"M59.177 29.5s-1.25 0-1.25 2.5c0 14.47-11.786 26.244-26.253 26.244C17.206 58.244 5.417 46.47 5.417 32c0-13.837 11.414-25.29 25.005-26.26v6.252c0 .622-.318 1.635.198 1.985a1.88 1.88 0 0 0 1.75.19l21.37-8.545c.837-.334 1.687-1.133 1.687-2.384C55.425 1.99 53.944 2 53.044 2h-21.37C15.134 2 1.667 15.46 1.667 32c0 16.543 13.467 30 30.007 30 16.538 0 29.918-13.458 29.993-30 .01-2.5-1.24-2.5-1.24-2.5h-1.25\" />\n//     </svg>\n// );\n//购物车\n\nclass ShopCar extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getdata = () => {\n      let buyCount = this.props.car.buyCount;\n      let goods = this.state.goods;\n      let shopids = Object.keys(buyCount);\n      shopids.forEach((item, index) => {\n        fetch(\"\".concat(url, \"/api/buygoods/\") + item).then(res => res.json()).then(data => {\n          data['num'] = buyCount[item]; //存储没见商品的数量\n\n          goods.push(data);\n          this.setState({\n            goods\n          });\n        });\n      });\n      this.getResult();\n    };\n\n    this.getResult = event => {\n      let time = setTimeout(event => {\n        clearTimeout(time);\n        this.totalPrice();\n      }, 200);\n    };\n\n    this.totalPrice = () => {\n      let price = 0;\n      let count = 0;\n      let goods = this.state.goods;\n\n      for (let key of goods) {\n        price += key.num * key.price;\n        count += key.num;\n      }\n\n      this.setState({\n        price,\n        count\n      }, event => {\n        console.log(this.state);\n      });\n    };\n\n    this.updateNum = (val, index) => {\n      if (val === 10) {\n        offline('最多购买10件');\n        return;\n      }\n\n      let goods = this.state.goods;\n      let addgood = this.props.addgood;\n      let value = goods[index].num;\n      let id = goods[index].shopid;\n\n      if (val > value) {\n        goods[index].num++;\n        this.setState({\n          goods\n        });\n        addgood({\n          id,\n          num: 1\n        });\n      } else {\n        if (goods[index].num) {\n          goods[index].num--;\n          this.setState({\n            goods\n          });\n          addgood({\n            id,\n            num: -1\n          });\n        }\n      }\n\n      this.totalPrice();\n    };\n\n    this.state = {\n      goods: [],\n      price: 0,\n      count: 0 // this.totalPrice = this.totalPrice.bind(this)\n\n    };\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      Toast.hide();\n    }, 3000);\n    this.getdata();\n    this.totalPrice();\n  }\n\n  render() {\n    let _this$state = this.state,\n        goods = _this$state.goods,\n        price = _this$state.price,\n        count = _this$state.count;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(Top, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: 'shopcar',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(List, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, goods.length > 0 && goods.map((item, index) => {\n      return React.createElement(List.Item, {\n        key: index,\n        thumb: React.createElement(Checkbox, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }),\n        wrap: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: '',\n        src: item.picurl,\n        width: '100%',\n        height: '100%',\n        alt: item.title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: 'buy_title',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, item.title), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          marginRight: '5px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, \"\\u552E\\u4EF7:\"), React.createElement(\"span\", {\n        style: {\n          color: '#797979',\n          fontSize: '0.25rem'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, item.symbol, item.price)), React.createElement(\"div\", {\n        className: 'num',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(Stepper // className={'stepper'}\n      // downStyle={'0.5rem'}\n      , {\n        style: {},\n        showNumber: true,\n        max: 10,\n        min: 0,\n        defaultValue: item.num,\n        onChange: val => this.updateNum(val, index),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }), React.createElement(\"i\", {\n        className: 'iconfont icon-shanchu',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }))));\n    })), React.createElement(\"div\", {\n      className: 'buy_footer',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'buy_span',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"\\u5171\\u4EF6\", count, \" \\u91D1\\u989D\\uFF1A\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, price, \" \", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"\\u5143\"))), React.createElement(\"div\", {\n      style: {\n        color: '',\n        fontSize: '0.35rem'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: '/',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, \"\\u7EE7\\u7EED\\u8D2D\\u7269\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: 'buy_button',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \" \\u53BB\\u7ED3\\u7B97\")))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    car: state\n  };\n};\n\nconst mapDispatchToProps = {\n  addgood,\n  delgood,\n  getgoodsnum\n};\nShopCar = connect(mapStateToProps, mapDispatchToProps)(ShopCar);\nexport default ShopCar;","map":{"version":3,"sources":["G:\\tanzhou\\react_shizhan\\xiaomireact\\xiaomi\\src\\components\\shopCar\\shopCar.jsx"],"names":["React","Component","List","Stepper","Checkbox","Toast","Link","connect","offline","Top","url","goback","addgood","delgood","getgoodsnum","shopTools","ShopCar","constructor","props","getdata","buyCount","car","goods","state","shopids","Object","keys","forEach","item","index","fetch","then","res","json","data","push","setState","getResult","event","time","setTimeout","clearTimeout","totalPrice","price","count","key","num","console","log","updateNum","val","value","id","shopid","componentDidMount","hide","render","length","map","picurl","title","marginRight","color","fontSize","symbol","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {List,Stepper , Checkbox,Toast} from \"antd-mobile\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {connect} from \"react-redux\";\r\n\r\nimport {offline} from \"../../common/js/toast/toast\";\r\nimport Top from \"../Header/top\";\r\nimport './shopcar.css'\r\nimport url from \"../util\";\r\nimport {goback} from \"../util\";\r\n\r\nimport {addgood,delgood,getgoodsnum} from \"../../actions/cart\";\r\nimport {shopTools} from \"../util\";\r\n\r\n// const customIcon = () => (\r\n//     <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\" className=\"am-icon am-icon-md\">\r\n//         <path fillRule=\"evenodd\" d=\"M59.177 29.5s-1.25 0-1.25 2.5c0 14.47-11.786 26.244-26.253 26.244C17.206 58.244 5.417 46.47 5.417 32c0-13.837 11.414-25.29 25.005-26.26v6.252c0 .622-.318 1.635.198 1.985a1.88 1.88 0 0 0 1.75.19l21.37-8.545c.837-.334 1.687-1.133 1.687-2.384C55.425 1.99 53.944 2 53.044 2h-21.37C15.134 2 1.667 15.46 1.667 32c0 16.543 13.467 30 30.007 30 16.538 0 29.918-13.458 29.993-30 .01-2.5-1.24-2.5-1.24-2.5h-1.25\" />\r\n//     </svg>\r\n// );\r\n//购物车\r\nclass ShopCar extends Component {\r\n    constructor(props){\r\n        super(props);\r\n        this.state={\r\n            goods:[],\r\n            price:0,\r\n            count:0\r\n        }\r\n        // this.totalPrice = this.totalPrice.bind(this)\r\n    }\r\n    componentDidMount() {\r\n        setTimeout(() => {\r\n            Toast.hide();\r\n        }, 3000);\r\n        this.getdata();\r\n        this.totalPrice()\r\n    }\r\n\r\n\r\n    getdata= ()=>{\r\n        let {buyCount} = this.props.car;\r\n        let {goods} = this.state;\r\n        let shopids = Object.keys(buyCount);\r\n        shopids.forEach((item,index)=>{\r\n            fetch(`${url}/api/buygoods/`+item)\r\n                .then(res=>res.json())\r\n                .then((data)=>{\r\n                    data['num'] = buyCount[item];   //存储没见商品的数量\r\n                    goods.push(data);\r\n                    this.setState({\r\n                        goods\r\n                    },)\r\n                })\r\n        });\r\n        this.getResult()\r\n    };\r\n    getResult= (event)=>{\r\n        let time = setTimeout((event)=>{\r\n            clearTimeout(time);\r\n            this.totalPrice()\r\n        },200)\r\n    };\r\n\r\n    totalPrice= ()=>{\r\n        let price = 0;\r\n        let count = 0;\r\n        let goods = this.state.goods;\r\n       for(let key of goods){\r\n            price += key.num * key.price;\r\n           count += key.num;\r\n       }\r\n        this.setState({\r\n            price,\r\n            count\r\n        },(event)=>{\r\n            console.log(this.state);\r\n        })\r\n    };\r\n    updateNum=(val,index)=>{\r\n       if(val === 10){\r\n           offline('最多购买10件');\r\n           return\r\n       }\r\n        let {goods} = this.state;\r\n        let {addgood} = this.props;\r\n       let value = goods[index].num;\r\n        let id = goods[index].shopid;\r\n        if(val > value){\r\n           goods[index].num++;\r\n           this.setState({\r\n               goods\r\n           });\r\n           addgood({\r\n                id,\r\n               num:1\r\n           })\r\n       }else {\r\n             if(goods[index].num){\r\n                 goods[index].num--;\r\n                 this.setState({\r\n                     goods\r\n                 });\r\n                 addgood({\r\n                     id,\r\n                     num:-1\r\n                 })\r\n             }\r\n        }\r\n        this.totalPrice()\r\n    };\r\n    render() {\r\n        let {goods,price,count} = this.state;\r\n        return (\r\n            <div>\r\n                <Top/>\r\n               <div className={'shopcar'}>\r\n                   <List>\r\n                       {\r\n                           goods.length > 0 && (\r\n                               goods.map((item,index)=>{\r\n                                   return (\r\n                                       <List.Item\r\n                                           key={index}\r\n                                           thumb={\r\n                                               <Checkbox/>\r\n                                           }\r\n                                           wrap={true}\r\n                                       >\r\n                                           <img className={''} src={item.picurl} width={'100%'} height={'100%'} alt={item.title}/>\r\n                                           <div >\r\n                                               <div className={'buy_title'} >{item.title}</div>\r\n                                               <div><span style={{marginRight:'5px'}}>售价:</span><span style={{color:'#797979',fontSize:'0.25rem'}}>{item.symbol}{item.price}</span></div>\r\n                                               <div className={'num'} >\r\n                                                   <Stepper\r\n                                                       // className={'stepper'}\r\n                                                       // downStyle={'0.5rem'}\r\n                                                       style={{  }}\r\n                                                       showNumber\r\n                                                       max={10}\r\n                                                       min={0}\r\n                                                       defaultValue={item.num}\r\n                                                       onChange={(val)=>this.updateNum(val,index)}\r\n                                                   />\r\n                                                   <i className={'iconfont icon-shanchu'}/>\r\n                                               </div>\r\n                                           </div>\r\n                                       </List.Item>\r\n\r\n                                   )\r\n                               })\r\n                           )\r\n                       }\r\n                   </List>\r\n                    <div className={'buy_footer'}>\r\n                        <div className={'buy_span'}><span >共件{count} 金额：</span><div>{price} <span>元</span></div></div>\r\n                        <div style={{color:'',fontSize:'0.35rem',}}><Link to={'/'}>继续购物</Link></div>\r\n                        <div><button className={'buy_button'}> 去结算</button></div>\r\n                    </div>\r\n               </div>\r\n\r\n            </div>\r\n        );\r\n    }\r\n}\r\nconst mapStateToProps = (state)=>{\r\n    return {car:state}\r\n};\r\nconst mapDispatchToProps = {\r\n    addgood,\r\n    delgood,\r\n    getgoodsnum\r\n};\r\nShopCar = connect(mapStateToProps,mapDispatchToProps)(ShopCar);\r\nexport default ShopCar;"]},"metadata":{},"sourceType":"module"}